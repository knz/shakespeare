role client
  :prepare  $COCKROACH workload init kv --drop --db db$port --pprofport $pprof \\
			'postgres://root@localhost:'$port'?sslmode=disable'
  :start	$COCKROACH workload run kv --db db$port --pprofport $pprof \\
  			--concurrency 1 --max-rate 200 --cycle-length 10 \\
			--display-every .25s --abstime --skip-final-report --tolerate-errors \\
			'postgres://root@localhost:'$port'?sslmode=disable' \\
			>kv.log 2>&1 & ret=$?; echo $!>wpid; exit $ret
  cleanup	if test -e wpid; then kill $(cat wpid) && sleep 1 && kill -9 $(cat wpid) || true; fi; rm -f kv.log
  spotlight	tail -F kv.log
  signal	errors delta at      ^(?P<ts_rfc3339>)\s+(?P<delta>\S+).*$
  signal	throughput scalar at ^(?P<ts_rfc3339>)\s+\S+\s+(?P<scalar>\S+).*$
  signal	lat50 scalar at      ^(?P<ts_rfc3339>)(?:\s+\S+){3}\s+(?P<scalar>\S+).*$
  signal	lat95 scalar at      ^(?P<ts_rfc3339>)(?:\s+\S+){4}\s+(?P<scalar>\S+).*$
  signal	lat99 scalar at      ^(?P<ts_rfc3339>)(?:\s+\S+){5}\s+(?P<scalar>\S+).*$
end
